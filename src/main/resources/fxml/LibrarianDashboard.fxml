<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<?import javafx.collections.FXCollections?>
<?import java.lang.String?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<BorderPane xmlns="http://javafx.com/javafx/24" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.library.controller.LibrarianDashboardController"
            styleClass="dashboard-root">
    
    <!-- Top Navigation Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="top-bar">
            <padding>
                <Insets top="12" right="20" bottom="12" left="20"/>
            </padding>

            <ImageView preserveRatio="true"
                       styleClass="logo-dashboard">
                <Image url="/images/logo.png"/>
            </ImageView>
            <Label text="Librarian Dashboard" styleClass="dashboard-title"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Label fx:id="welcomeLabel" text="Welcome, Librarian!" styleClass="welcome-label"/>
            <Button fx:id="logoutButton" text="Logout" onAction="#handleLogout" styleClass="logout-button"/>
        </HBox>
    </top>
    
    <!-- Left Sidebar -->
    <left>
        <VBox spacing="8" styleClass="sidebar">
            <padding>
                <Insets topRightBottomLeft="15"/>
            </padding>
            
            <Label text="Navigation" styleClass="sidebar-header"/>
            
            <Button fx:id="requestsTabButton" text="ðŸ“‹ Borrow Requests" onAction="#switchToRequests" 
                    maxWidth="Infinity" styleClass="nav-button-active"/>
            
            <Button fx:id="inventoryTabButton" text="ðŸ“š Inventory" onAction="#switchToInventory" 
                    maxWidth="Infinity" styleClass="nav-button"/>
            
            <Button fx:id="membersTabButton" text="ðŸ‘¥ Members" onAction="#switchToMembers" 
                    maxWidth="Infinity" styleClass="nav-button"/>
            
            <Separator styleClass="sidebar-separator"/>
            
            <Label text="Quick Actions" styleClass="sidebar-header">
                <padding>
                    <Insets top="8" bottom="8"/>
                </padding>
            </Label>
            
            <Button text="âŠ• Issue Book" onAction="#handleIssueBook" maxWidth="Infinity" 
                    styleClass="primary-button"/>
            
            <Button text="âŠ– Return Book" onAction="#handleReturnBook" maxWidth="Infinity" 
                    styleClass="secondary-button"/>
        </VBox>
    </left>
    
    <!-- Main Content Area with ScrollPane -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" 
                    styleClass="content-scroll-pane" 
                    hbarPolicy="NEVER">
            <StackPane fx:id="contentPane" styleClass="content-area">
                <padding>
                    <Insets topRightBottomLeft="20"/>
                </padding>
                
                <!-- Requests View -->
                <VBox fx:id="requestsView" spacing="20">
                    
                    <!-- Statistics Cards -->
                    <HBox spacing="15">
                        <VBox spacing="6" HBox.hgrow="ALWAYS" styleClass="stat-card">
                            <padding>
                                <Insets topRightBottomLeft="15"/>
                            </padding>
                            <Label text="Pending Requests" styleClass="stat-label"/>
                            <Label fx:id="pendingRequestsLabel" text="0" styleClass="stat-value"/>
                        </VBox>
                        
                        <VBox spacing="6" HBox.hgrow="ALWAYS" styleClass="stat-card">
                            <padding>
                                <Insets topRightBottomLeft="15"/>
                            </padding>
                            <Label text="Books Issued Today" styleClass="stat-label"/>
                            <Label fx:id="issuedTodayLabel" text="0" styleClass="stat-value-success"/>
                        </VBox>
                        
                        <VBox spacing="6" HBox.hgrow="ALWAYS" styleClass="stat-card">
                            <padding>
                                <Insets topRightBottomLeft="15"/>
                            </padding>
                            <Label text="Overdue Returns" styleClass="stat-label"/>
                            <Label fx:id="overdueReturnsLabel" text="0" styleClass="stat-value-danger"/>
                        </VBox>
                    </HBox>
                    
                    <!-- Requests Table -->
                    <VBox spacing="12" VBox.vgrow="ALWAYS" styleClass="content-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label text="Borrow Requests" styleClass="section-title"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <ComboBox fx:id="requestFilterCombo" promptText="Filter by status" 
                                     prefWidth="150" styleClass="filter-combo">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="All"/>
                                        <String fx:value="Pending"/>
                                        <String fx:value="Approved"/>
                                        <String fx:value="Rejected"/>
                                    </FXCollections>
                                </items>
                            </ComboBox>
                            <Button text="Refresh" onAction="#handleRefreshRequests" styleClass="refresh-button"/>
                        </HBox>
                        
                        <TableView fx:id="requestsTable" VBox.vgrow="ALWAYS" 
                                  styleClass="data-table" prefHeight="400">
                            <columns>
                                <TableColumn fx:id="reqIdColumn" text="Request ID" prefWidth="100"/>
                                <TableColumn fx:id="reqMemberColumn" text="Member" prefWidth="150"/>
                                <TableColumn fx:id="reqBookColumn" text="Book Title" prefWidth="200"/>
                                <TableColumn fx:id="reqDateColumn" text="Request Date" prefWidth="120"/>
                                <TableColumn fx:id="reqStatusColumn" text="Status" prefWidth="100"/>
                                <TableColumn fx:id="reqActionColumn" text="Actions" prefWidth="180"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
                
                <!-- Inventory View -->
                <VBox fx:id="inventoryView" spacing="20" visible="false">
                    
                    <!-- Search and Filter -->
                    <VBox spacing="12" styleClass="content-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        
                        <Label text="Library Inventory" styleClass="section-title"/>
                        
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <TextField fx:id="inventorySearchField" promptText="Search by title, author, ISBN..." 
                                      HBox.hgrow="ALWAYS" styleClass="search-field"/>
                            
                            <Button text="Search" onAction="#handleInventorySearch" styleClass="search-button"/>
                        </HBox>
                    </VBox>
                    
                    <!-- Inventory Table -->
                    <VBox spacing="12" VBox.vgrow="ALWAYS" styleClass="content-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        
                        <TableView fx:id="inventoryTable" VBox.vgrow="ALWAYS" 
                                  styleClass="data-table" prefHeight="500">
                            <columns>
                                <TableColumn fx:id="invIsbnColumn" text="ISBN" prefWidth="120"/>
                                <TableColumn fx:id="invTitleColumn" text="Title" prefWidth="250"/>
                                <TableColumn fx:id="invAuthorColumn" text="Author" prefWidth="180"/>
                                <TableColumn fx:id="invCategoryColumn" text="Category" prefWidth="130"/>
                                <TableColumn fx:id="invTotalColumn" text="Total Copies" prefWidth="100"/>
                                <TableColumn fx:id="invAvailableColumn" text="Available" prefWidth="100"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
                
                <!-- Members View -->
                <VBox fx:id="membersView" spacing="20" visible="false">
                    
                    <!-- Search Members -->
                    <VBox spacing="12" styleClass="content-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        
                        <Label text="Member Management" styleClass="section-title"/>
                        
                        <HBox spacing="12" alignment="CENTER_LEFT">
                            <TextField fx:id="memberSearchField" promptText="Search by name, email, or member ID..." 
                                      HBox.hgrow="ALWAYS" styleClass="search-field"/>
                            
                            <Button text="Search" onAction="#handleMemberSearch" styleClass="search-button"/>
                        </HBox>
                    </VBox>
                    
                    <!-- Members Table -->
                    <VBox spacing="12" VBox.vgrow="ALWAYS" styleClass="content-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        
                        <TableView fx:id="membersTable" VBox.vgrow="ALWAYS" 
                                  styleClass="data-table" prefHeight="500">
                            <columns>
                                <TableColumn fx:id="memberIdColumn" text="Member ID" prefWidth="100"/>
                                <TableColumn fx:id="memberNameColumn" text="Name" prefWidth="180"/>
                                <TableColumn fx:id="memberEmailColumn" text="Email" prefWidth="200"/>
                                <TableColumn fx:id="memberJoinDateColumn" text="Join Date" prefWidth="120"/>
                                <TableColumn fx:id="memberBooksColumn" text="Books Out" prefWidth="100"/>
                                <TableColumn fx:id="memberStatusColumn" text="Status" prefWidth="100"/>
                                <TableColumn fx:id="memberActionColumn" text="Actions" prefWidth="150"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </StackPane>
        </ScrollPane>
    </center>
    
    <stylesheets>
        <String fx:value="/styles.css"/>
    </stylesheets>
</BorderPane>

<!-- 
Additional CSS classes used:
- filter-combo (for request status filter)
- content-scroll-pane (for main scrollable area)

Padding reduced from:
- Top bar: 15px â†’ 12px
- Sidebar: 20px â†’ 15px
- Content area: 30px â†’ 20px
- Stat cards: 20px â†’ 15px
- Content cards: 25px â†’ 20px
- Card spacing: 25px â†’ 20px
- Internal spacing: 15px â†’ 12px

ScrollPane added to center region for better content handling
-->