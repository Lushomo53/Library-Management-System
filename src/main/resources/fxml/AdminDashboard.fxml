<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<?import javafx.collections.FXCollections?>
<?import java.lang.String?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<BorderPane xmlns="http://javafx.com/javafx/24" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.library.controller.AdminDashboardController"
            styleClass="dashboard-root">
    
    <!-- Top Navigation Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="top-bar">
            <padding>
                <Insets top="15" right="25" bottom="15" left="25"/>
            </padding>

            <ImageView preserveRatio="true"
                       styleClass="logo-dashboard">
                <Image url="/images/logo.png"/>
            </ImageView>
            <Label text="Admin Dashboard" styleClass="dashboard-title"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Label fx:id="welcomeLabel" text="Welcome, Admin!" styleClass="welcome-label"/>
            <Button fx:id="logoutButton" text="Logout" onAction="#handleLogout" styleClass="logout-button"/>
        </HBox>
    </top>
    
    <!-- Left Sidebar -->
    <left>
        <VBox spacing="10" styleClass="sidebar">
            <padding>
                <Insets topRightBottomLeft="20"/>
            </padding>
            
            <Label text="Navigation" styleClass="sidebar-header"/>
            
            <Button fx:id="stockTabButton" text="ðŸ“¦ Stock Management" onAction="#switchToStock" 
                    maxWidth="Infinity" styleClass="nav-button-active"/>
            
            <Button fx:id="librariansTabButton" text="ðŸ‘¤ Librarians" onAction="#switchToLibrarians" 
                    maxWidth="Infinity" styleClass="nav-button"/>
            
            <Button fx:id="membersTabButton" text="ðŸ‘¥ Members" onAction="#switchToMembers" 
                    maxWidth="Infinity" styleClass="nav-button"/>
            
            <Button fx:id="reportsTabButton" text="ðŸ“Š Reports" onAction="#switchToReports" 
                    maxWidth="Infinity" styleClass="nav-button"/>
            
            <Separator styleClass="sidebar-separator"/>
            
            <Label text="Quick Actions" styleClass="sidebar-header">
                <padding>
                    <Insets top="10" bottom="10"/>
                </padding>
            </Label>
            
            <Button text="âž• Add Book" onAction="#handleAddBook" maxWidth="Infinity" 
                    styleClass="primary-button"/>
            
            <Button text="âž• Add Librarian" onAction="#handleAddLibrarian" maxWidth="Infinity" 
                    styleClass="secondary-button"/>
        </VBox>
    </left>
    
    <!-- Main Content Area -->
    <center>
        <StackPane fx:id="contentPane" styleClass="content-area">
            <padding>
                <Insets topRightBottomLeft="30"/>
            </padding>
            
            <!-- Stock Management View -->
            <VBox fx:id="stockView" spacing="25">
                
                <!-- Statistics Cards -->
                <GridPane hgap="20" vgap="20">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="25" hgrow="ALWAYS"/>
                    </columnConstraints>
                    
                    <VBox spacing="8" GridPane.columnIndex="0" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Total Books" styleClass="stat-label"/>
                        <Label fx:id="totalBooksLabel" text="0" styleClass="stat-value"/>
                    </VBox>
                    
                    <VBox spacing="8" GridPane.columnIndex="1" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Books Issued" styleClass="stat-label"/>
                        <Label fx:id="booksIssuedLabel" text="0" styleClass="stat-value-success"/>
                    </VBox>
                    
                    <VBox spacing="8" GridPane.columnIndex="2" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Available" styleClass="stat-label"/>
                        <Label fx:id="booksAvailableLabel" text="0" styleClass="stat-value-info"/>
                    </VBox>
                    
                    <VBox spacing="8" GridPane.columnIndex="3" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Low Stock" styleClass="stat-label"/>
                        <Label fx:id="lowStockLabel" text="0" styleClass="stat-value-danger"/>
                    </VBox>
                </GridPane>
                
                <!-- Search and Actions -->
                <VBox spacing="15" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Label text="Book Inventory" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="âž• Add New Book" onAction="#handleAddBook" styleClass="action-button-primary"/>
                    </HBox>
                    
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <TextField fx:id="stockSearchField" promptText="Search by title, author, ISBN..." 
                                  HBox.hgrow="ALWAYS" styleClass="search-field"/>
                        
                        <Button text="Search" onAction="#handleStockSearch" styleClass="search-button"/>
                        <Button text="Refresh" onAction="#handleRefreshStock" styleClass="refresh-button"/>
                    </HBox>
                </VBox>
                
                <!-- Stock Table -->
                <VBox spacing="15" VBox.vgrow="ALWAYS" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <TableView fx:id="stockTable" VBox.vgrow="ALWAYS" styleClass="data-table">
                        <columns>
                            <TableColumn fx:id="stockIsbnColumn" text="ISBN" prefWidth="120"/>
                            <TableColumn fx:id="stockTitleColumn" text="Title" prefWidth="250"/>
                            <TableColumn fx:id="stockAuthorColumn" text="Author" prefWidth="180"/>
                            <TableColumn fx:id="stockCategoryColumn" text="Category" prefWidth="120"/>
                            <TableColumn fx:id="stockTotalColumn" text="Total" prefWidth="80"/>
                            <TableColumn fx:id="stockAvailableColumn" text="Available" prefWidth="80"/>
                            <TableColumn fx:id="stockActionColumn" text="Actions" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </VBox>
            
            <!-- Librarians View -->
            <VBox fx:id="librariansView" spacing="25" visible="false">
                
                <!-- Librarian Stats -->
                <HBox spacing="20">
                    <VBox spacing="8" HBox.hgrow="ALWAYS" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Total Librarians" styleClass="stat-label"/>
                        <Label fx:id="totalLibrariansLabel" text="0" styleClass="stat-value"/>
                    </VBox>
                    
                    <VBox spacing="8" HBox.hgrow="ALWAYS" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Active Librarians" styleClass="stat-label"/>
                        <Label fx:id="activeLibrariansLabel" text="0" styleClass="stat-value-success"/>
                    </VBox>
                </HBox>
                
                <!-- Search Librarians -->
                <VBox spacing="15" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Label text="Librarian Management" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="âž• Add Librarian" onAction="#handleAddLibrarian" styleClass="action-button-primary"/>
                    </HBox>
                    
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <TextField fx:id="librarianSearchField" promptText="Search by name or employee ID..." 
                                  HBox.hgrow="ALWAYS" styleClass="search-field"/>
                        
                        <Button text="Search" onAction="#handleLibrarianSearch" styleClass="search-button"/>
                    </HBox>
                </VBox>
                
                <!-- Librarians Table -->
                <VBox spacing="15" VBox.vgrow="ALWAYS" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <TableView fx:id="librariansTable" VBox.vgrow="ALWAYS" styleClass="data-table">
                        <columns>
                            <TableColumn fx:id="libIdColumn" text="Employee ID" prefWidth="120"/>
                            <TableColumn fx:id="libNameColumn" text="Name" prefWidth="200"/>
                            <TableColumn fx:id="libEmailColumn" text="Email" prefWidth="220"/>
                            <TableColumn fx:id="libPhoneColumn" text="Phone" prefWidth="140"/>
                            <TableColumn fx:id="libJoinDateColumn" text="Join Date" prefWidth="120"/>
                            <TableColumn fx:id="libStatusColumn" text="Status" prefWidth="100"/>
                            <TableColumn fx:id="libActionColumn" text="Actions" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </VBox>
            
            <!-- Members View -->
            <VBox fx:id="membersView" spacing="25" visible="false">
                
                <!-- Member Stats -->
                <HBox spacing="20">
                    <VBox spacing="8" HBox.hgrow="ALWAYS" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Total Members" styleClass="stat-label"/>
                        <Label fx:id="totalMembersLabel" text="0" styleClass="stat-value"/>
                    </VBox>
                    
                    <VBox spacing="8" HBox.hgrow="ALWAYS" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Active Members" styleClass="stat-label"/>
                        <Label fx:id="activeMembersLabel" text="0" styleClass="stat-value-success"/>
                    </VBox>
                    
                    <VBox spacing="8" HBox.hgrow="ALWAYS" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Pending Applications" styleClass="stat-label"/>
                        <Label fx:id="pendingApplicationsLabel" text="0" styleClass="stat-value-info"/>
                    </VBox>
                </HBox>
                
                <!-- Search Members -->
                <VBox spacing="15" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <Label text="Member Management" styleClass="section-title"/>
                    
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <TextField fx:id="memberSearchField" promptText="Search by name, email, or member ID..." 
                                  HBox.hgrow="ALWAYS" styleClass="search-field"/>
                        
                        <Button text="Search" onAction="#handleMemberSearch" styleClass="search-button"/>
                    </HBox>
                </VBox>
                
                <!-- Members Table -->
                <VBox spacing="15" VBox.vgrow="ALWAYS" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <TableView fx:id="adminMembersTable" VBox.vgrow="ALWAYS" styleClass="data-table">
                        <columns>
                            <TableColumn fx:id="adminMemberIdColumn" text="Member ID" prefWidth="100"/>
                            <TableColumn fx:id="adminMemberNameColumn" text="Name" prefWidth="180"/>
                            <TableColumn fx:id="adminMemberEmailColumn" text="Email" prefWidth="200"/>
                            <TableColumn fx:id="adminMemberPhoneColumn" text="Phone" prefWidth="140"/>
                            <TableColumn fx:id="adminMemberJoinDateColumn" text="Join Date" prefWidth="120"/>
                            <TableColumn fx:id="adminMemberBooksColumn" text="Books Out" prefWidth="100"/>
                            <TableColumn fx:id="adminMemberStatusColumn" text="Status" prefWidth="100"/>
                            <TableColumn fx:id="adminMemberActionColumn" text="Actions" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </VBox>
            
            <!-- Reports View -->
            <VBox fx:id="reportsView" spacing="25" visible="false">
                
                <!-- Report Type Selection -->
                <VBox spacing="15" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <Label text="Generate Reports" styleClass="section-title"/>
                    
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <ComboBox fx:id="reportTypeCombo" promptText="Select report type" 
                                 prefWidth="250" styleClass="report-combo">
                            <items>
                                <FXCollections fx:factory="observableArrayList">
                                    <String fx:value="Books Issued Report"/>
                                    <String fx:value="Overdue Books Report"/>
                                    <String fx:value="Member Activity Report"/>
                                    <String fx:value="Popular Books Report"/>
                                    <String fx:value="Inventory Status Report"/>
                                    <String fx:value="Revenue Report"/>
                                </FXCollections>
                            </items>
                        </ComboBox>
                        
                        <Label text="From:" styleClass="date-label"/>
                        <DatePicker fx:id="reportStartDate" promptText="Start Date" 
                                   prefWidth="140" styleClass="date-picker-field"/>
                        
                        <Label text="To:" styleClass="date-label"/>
                        <DatePicker fx:id="reportEndDate" promptText="End Date" 
                                   prefWidth="140" styleClass="date-picker-field"/>
                        
                        <Region HBox.hgrow="ALWAYS"/>
                        
                        <Button text="Generate" onAction="#handleGenerateReport" styleClass="generate-button"/>
                        <Button text="Export PDF" onAction="#handleExportPDF" styleClass="export-button"/>
                    </HBox>
                </VBox>
                
                <!-- Report Summary Cards -->
                <GridPane hgap="20" vgap="20">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS"/>
                        <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS"/>
                    </columnConstraints>
                    
                    <VBox spacing="8" GridPane.columnIndex="0" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Total Transactions" styleClass="stat-label"/>
                        <Label fx:id="totalTransactionsLabel" text="0" styleClass="stat-value"/>
                        <Label text="This Month" styleClass="stat-sublabel"/>
                    </VBox>
                    
                    <VBox spacing="8" GridPane.columnIndex="1" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="Active Users" styleClass="stat-label"/>
                        <Label fx:id="activeUsersLabel" text="0" styleClass="stat-value-success"/>
                        <Label text="This Week" styleClass="stat-sublabel"/>
                    </VBox>
                    
                    <VBox spacing="8" GridPane.columnIndex="2" styleClass="stat-card">
                        <padding>
                            <Insets topRightBottomLeft="20"/>
                        </padding>
                        <Label text="System Uptime" styleClass="stat-label"/>
                        <Label fx:id="systemUptimeLabel" text="99.9%" styleClass="stat-value-info"/>
                        <Label text="Last 30 Days" styleClass="stat-sublabel"/>
                    </VBox>
                </GridPane>
                
                <!-- Report Data Display -->
                <VBox spacing="15" VBox.vgrow="ALWAYS" styleClass="content-card">
                    <padding>
                        <Insets topRightBottomLeft="25"/>
                    </padding>
                    
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Label text="Report Data" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="reportStatusLabel" text="No report generated" styleClass="report-status-label"/>
                    </HBox>
                    
                    <TableView fx:id="reportDataTable" VBox.vgrow="ALWAYS" styleClass="data-table">
                        <columns>
                            <TableColumn fx:id="reportCol1" text="Column 1" prefWidth="150"/>
                            <TableColumn fx:id="reportCol2" text="Column 2" prefWidth="150"/>
                            <TableColumn fx:id="reportCol3" text="Column 3" prefWidth="150"/>
                            <TableColumn fx:id="reportCol4" text="Column 4" prefWidth="150"/>
                            <TableColumn fx:id="reportCol5" text="Column 5" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </VBox>
        </StackPane>
    </center>
    
    <stylesheets>
        <String fx:value="/styles.css"/>
    </stylesheets>
</BorderPane>